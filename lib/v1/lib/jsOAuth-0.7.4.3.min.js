var exports=exports||this;exports.OAuth=(function(d){var b="1.0";var i="2.0";function m(r){if(!(this instanceof m)){return new m(r)}return this.init(r)}m.prototype={realm:"",requestTokenUrl:"",authorizationUrl:"",accessTokenUrl:"",init:function(s){var t="";var r={enablePrivilege:s.enablePrivilege||false,consumerKey:s.consumerKey,consumerSecret:s.consumerSecret,accessTokenKey:s.accessTokenKey||t,accessTokenSecret:s.accessTokenSecret||t,verifier:"",signatureMethod:s.signatureMethod||"HMAC-SHA1"};this.realm=s.realm||t;this.requestTokenUrl=s.requestTokenUrl||t;this.authorizationUrl=s.authorizationUrl||t;this.accessTokenUrl=s.accessTokenUrl||t;this.getAccessToken=function(){return[r.accessTokenKey,r.accessTokenSecret]};this.setAccessToken=function(u){r.accessTokenKey=u[0];r.accessTokenSecret=u[1]};this.getAccessToken=function(){return[r.accessTokenKey,r.accessTokenSecret]};this.setAccessToken=function(u){r.accessTokenKey=u[0];r.accessTokenSecret=u[1]};this.request=function(H){var u,v,B,z,F,x,G,A,E,w,C,y,D=[];u=H.method||"GET";v=H.url;B=H.data||{};z=H.headers||{};F=H.success||function(I){};x=H.failure||function(){};if(r.enablePrivilege){netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead UniversalBrowserWrite")}G=a();G.onreadystatechange=function(){if(G.readyState==4&&(G.status==200||G.status===0)){F({text:G.responseText})}else{if(G.readyState==4&&G.status!=200&&G.status!==0){x({text:G.responseText})}}};E={oauth_callback:"oob",oauth_consumer_key:r.consumerKey,oauth_token:r.accessTokenSecret,oauth_signature_method:r.signatureMethod,oauth_timestamp:f(),oauth_nonce:e(),oauth_verifier:r.verifier,oauth_version:b};w=r.signatureMethod;C=q(u,v,E,B);y=m.signatureMethod[w](r.consumerSecret,r.accessTokenSecret,C);E.oauth_signature=y;for(A in B){D.push(A+"="+B[A])}D=D.sort().join("&");if(u=="GET"){if(D){v+="?"+D}D=null}else{G.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}G.open(u,v,true);G.setRequestHeader("Authorization","OAuth "+l(E));G.setRequestHeader("X-Requested-With","XMLHttpRequest");for(A in z){G.setRequestHeader(A,z[A])}G.send(D)};return this},authenticate:function(w,x,v){var r=this;var u=this.getAccessToken();if(!(u[0]&&u[1])){var t=Array.slice.call(arguments);var y=function(){r.authenticate.apply(r,t)};this.getRequestToken({},y)}else{if(this.oauth_verifier){x(this)}else{var s=this.authorizeToken();window.open(s)}}},deauthenticate:function(r,s){},request:"",getAccessToken:"",setAccessToken:"",getRequestToken:function(s,t,r){this.request({method:"POST",url:this.requestTokenUrl,success:function(u){console.log(u)},failure:function(u){console.log(u)}})},authorizeToken:function(){},get:function(s,t,r){this.request({url:s,success:t,failure:r})},post:function(s,t,u,r){this.request({method:"POST",url:s,data:t,success:u,failure:r})},getJSON:function(s,t,r){this.get(s,function(u){t(JSON.parse(u.text))},r)}};m.signatureMethod={"HMAC-SHA1":function(r,t,u){var v,s;r=m.urlEncode(r);t=m.urlEncode(t||"");v=r+"&"+t;s=j(h.prototype,v,u);return d.btoa(s)}};function l(t){var r=[],s;for(s in t){if(t[s]&&t[s]!==undefined&&t[s]!==""){r.push(s+'="'+m.urlEncode(t[s]+"")+'"')}}return r.sort().join(", ")}function q(w,t,v,s){var r=[],u;for(u in v){if(v[u]&&v[u]!==undefined&&v[u]!==""){r.push(m.urlEncode(u)+"="+m.urlEncode(v[u]+""))}}console.log(s);for(u in s){if(s[u]&&s[u]!==undefined&&s[u]!==""){if(!v[u]){r.push(m.urlEncode(u)+"="+m.urlEncode(s[u]+""))}}}console.log(r);return[w,m.urlEncode(t),m.urlEncode(r.sort().join("&"))].join("&")}function f(){return parseInt(+new Date()/1000,10)}function e(w){function u(){return Math.floor(Math.random()*v.length)}w=w||64;var y=w/8,x="",t=y/4,s=y%4,r,v=["20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E"];for(r=0;r<t;r++){x+=v[u()]+v[u()]+v[u()]+v[u()]}for(r=0;r<s;r++){x+=v[u()]}return x}m.urlEncode=function(r){if(!r){return""}r=r+"";var v=/ |!|\*|"|'|\(|\)|;|:|@|&|=|\+|\$|,|\/|\?|%|#|\[|\]|<|>|\{|\}|\||\\|`|\^/,t=r.length,s,u=r.split("");for(s=0;s<t;s++){if(u[s].match(v)){u[s]="%"+(u[s].charCodeAt(0)).toString(16).toUpperCase()}}return u.join("")};m.urlDecode=function(r){if(!r){return""}return r.replace(/%[a-fA-F0-9]{2}/ig,function(s){return String.fromCharCode(parseInt(s.replace("%",""),16))})};function a(){var r;if(typeof d.Titanium!=="undefined"&&typeof d.Titanium.Network.createHTTPClient!="undefined"){r=d.Titanium.Network.createHTTPClient()}else{if(typeof require!=="undefined"){r=new require("xhr").XMLHttpRequest()}else{r=new d.XMLHttpRequest()}}return r}function h(t){if(t!==undefined){var r=t,s,u;if(r.constructor===String){r=o(r)}if(!(this instanceof h)){s=new h(t)}else{s=this}u=s.hash(r);return p(u)}else{if(!(this instanceof h)){return new h()}}return this}h.prototype=new h();h.prototype.blocksize=64;h.prototype.hash=function(P){var z=[1732584193,4023233417,2562383102,271733878,3285377520],y=[1518500249,1859775393,2400959708,3395469782],Q,u,R,U,T,V,W,x,r,F,S,N,M,L,J,I,G,O,s;function v(w,H,E,A){switch(w){case 0:return(H&E)|((~H)&A);case 1:case 3:return H^E^A;case 2:return(H&E)|(H&A)|(E&A)}return -1}if(P.constructor===String){P=o(P)}R=P.length;U=(Math.ceil((R+9)/this.blocksize)*this.blocksize)-(R+9);u=(Math.floor(R/4294967296));Q=(Math.floor(R%4294967296));T=[((u*8)>>24)&255,((u*8)>>16)&255,((u*8)>>8)&255,(u*8)&255,((Q*8)>>24)&255,((Q*8)>>16)&255,((Q*8)>>8)&255,(Q*8)&255];P=P.concat([128],k(U),T);V=Math.ceil(P.length/this.blocksize);for(W=0;W<V;W++){x=P.slice(W*this.blocksize,(W+1)*this.blocksize);r=x.length;F=[];for(S=0;S<r;S++){F[S>>>2]|=x[S]<<(24-(S-((S>>2)*4))*8)}N=z[0];M=z[1];L=z[2];J=z[3];I=z[4];for(G=0;G<80;G++){if(G>=16){F[G]=c(F[G-3]^F[G-8]^F[G-14]^F[G-16],1)}O=Math.floor(G/20);s=c(N,5)+v(O,M,L,J)+I+y[O]+F[G];I=J;J=L;L=c(M,30);M=N;N=s}z[0]+=N;z[1]+=M;z[2]+=L;z[3]+=J;z[4]+=I}return n(z)};function j(y,z,B,s){var w=o(z),t=o(B),u=w.length,r,v,A,x;if(u>y.blocksize){w=y.hash(w);u=w.length}w=w.concat(k(y.blocksize-u));v=w.slice(0);A=w.slice(0);for(x=0;x<y.blocksize;x++){v[x]^=92;A[x]^=54}r=y.hash(v.concat(y.hash(A.concat(t))));if(s){return p(r)}return g(r)}function k(s){var r=new Array(++s);return r.join(0).split("")}function o(y){var r=[],t,w,x,v,u,s;for(t=0;t<y.length;t++){w=y.charCodeAt(t);x=(w>>>24);v=(w>>>16);u=(w>>>8);s=w&255;if(x>0){r.push(x)}if(v>0){r.push(v)}if(u>0){r.push(u)}if(s>0){r.push(s)}}return r}function n(t){var r=[],s;for(s=0;s<t.length*32;s+=8){r.push((t[s>>>5]>>>(24-s%32))&255)}return r}function p(s){var u=[],r=s.length,t;for(t=0;t<r;t++){u.push((s[t]>>>4).toString(16));u.push((s[t]&15).toString(16))}return u.join("")}function g(s){var t="",r=s.length,u;for(u=0;u<r;u++){t+=String.fromCharCode(s[u])}return t}function c(s,r){return(s<<r)|(s>>>(32-r))}return m})(this);(function(b){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.btoa=b.btoa||function(f){var g=0,h=f.length,c,e,d="";for(;g<h;g+=3){c=[f.charCodeAt(g),f.charCodeAt(g+1),f.charCodeAt(g+2)];e=[c[0]>>2,((c[0]&3)<<4)|c[1]>>4,((c[1]&15)<<2)|c[2]>>6,c[2]&63];if(isNaN(c[1])){e[2]=64}if(isNaN(c[2])){e[3]=64}d+=a[e[0]]+a[e[1]]+a[e[2]]+a[e[3]]}return d}})(this);